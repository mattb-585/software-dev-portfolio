<%- include("../shared/header") %>
<div class="d-flex justify-content-between p-2 m-2 align-items-center cart-header">
    <h5 class="my-2">SHOPPING CART: Your shopping cart contains <%= cartItems.length %>  items</h5>
    <div>
        <button class="my-2">CONTINUE SHOPPING</button>
        <button class="my-2">CHECKOUT</button>
    </div>
</div>
<% if(errors.length > 0) { %> 
  <div class="alert alert-danger">
      <ul>
          <% for(let ctr = 0; ctr < errors.length; ctr++) { %>
              <li><%= errors[ctr].msg %> </li>
          <% } %> 
      </ul>
  </div>
<% } %>

<div class="p-2 m-2 cart-body">
    <table class="table-design">
        <tr>
          <th>Shipping to You</th>
          <th>Price</th>
          <th>Quantity</th>
          <th>Total</th>
        </tr>
        <% cartItems.forEach(cartItem => {%>
          <tr>
            <td><%= cartItem.name %></td>
            <td class="text-center">$<%= cartItem.price.toFixed(2) %></td>
            <td class="text-center">
                <form method="POST" class="d-inline" action="/cart/update-quantity/<%= cartItem.id %>">
                    <input class="w-25 mb-1" type="number" min="1" name="quantityUpdate" id="quantityUpdate" value="<%= cartItem.quantity %>">
                    <br>
                    <input type="hidden" name="price" value="<%= cartItem.price %> ">
                    <input type="hidden" name="_csrf" value="<%= token %>" />
                    <input class="table-submit" type="submit" value="Update Quantity">
                </form>
            </td>
            <td class="text-center">
                <p class="mb-1 pb-0">$<%= cartItem.total.toFixed(2) %></p>
                <a class="table-submit p-1" href="cart/delete/<%= cartItem.id %>">Delete</a>
            </td>
          </tr>
        <% }); %> 
        <tr>
          <td colspan="4" class="text-right">Subtotal: $<%= subTotal.toFixed(2) %></td>
        </tr>
        <tr>
          <td colspan="4" class="text-right">
            <div>
                <a class="table-submit p-1" href="/shop">CONTINUE SHOPPING</a>
                <a class="table-submit p-1" href="/cart/checkout">CHECKOUT</a>
            </div>
          </td>
        </tr>
      </table>
</div>
<%- include("../shared/footer") %>